<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Monkey VS Rocks</title>
<style>
  html,body{margin:0;height:100%;background:#000;font-family:system-ui,Arial}
  #wrap{display:flex;align-items:center;justify-content:center;height:100%}
  canvas{background:#5ec0ff;touch-action:none;display:block;border:0}
  #hud{position:fixed;top:10px;left:0;right:0;text-align:center;color:#fff;
       font-weight:600;text-shadow:0 1px 3px #000}
</style>
</head>
<body>
<div id="hud">Tap to jump • Survive 30s</div>
<div id="wrap"><canvas id="c" width="480" height="270"></canvas></div>
<script>
(() => {
  const c = document.getElementById('c');
  const ctx = c.getContext('2d', { alpha:false });

  // scale canvas to device size while keeping aspect
  function fit() {
    const w = window.innerWidth, h = window.innerHeight;
    const aspect = c.width / c.height;
    const s = Math.min(w / c.width, h / c.height);
    c.style.width  = (c.width  * s) + 'px';
    c.style.height = (c.height * s) + 'px';
  }
  window.addEventListener('resize', fit); fit();

  // WORLD
  const GROUND_Y = 220;        // ground line
  const gravity  = 0.6;
  const jumpVel  = -10;
  const rockMinGap = 70, rockMaxGap = 150;

  // PLAYER (drawn as a simple blue monkey icon)
  const player = { x:60, y:GROUND_Y-32, w:28, h:32, vy:0, onGround:true };

  // GAME STATE
  let rocks = [];
  let running = false;
  let t = 0;                 // frames
  let timeLeft = 30.0;       // seconds to win
  let speed = 4;             // world scroll speed
  let message = 'Tap to start';

  function reset() {
    rocks = [];
    player.y = GROUND_Y-32; player.vy = 0; player.onGround = true;
    t = 0; timeLeft = 30; speed = 4; running = false;
    message = 'Tap to start';
  }
  reset();

  // INPUT
  function jump() {
    if (!running) { running = true; message = ''; return; }
    if (player.onGround) { player.vy = jumpVel; player.onGround = false; }
  }
  c.addEventListener('pointerdown', jump);
  window.addEventListener('keydown', e => { if (e.code === 'Space' || e.code === 'ArrowUp') jump(); if(!running && e.code==='Enter') jump(); });

  // HELPERS
  function rand(a,b){ return Math.random()*(b-a)+a; }
  function rectsOverlap(a,b){
    return a.x < b.x+b.w && a.x+a.w > b.x && a.y < b.y+b.h && a.y+a.h > b.y;
  }

  // SPAWN ROCKS
  let nextSpawn = 60;
  function spawnIfNeeded() {
    if (t >= nextSpawn) {
      const size = 18 + Math.random()*12;
      rocks.push({ x:c.width + 10, y:GROUND_Y - size, w:size, h:size, r:size/2 });
      nextSpawn = t + Math.floor(rand(rockMinGap, rockMaxGap));
      // slightly ramp up difficulty
      speed += 0.02;
    }
  }

  // DRAW
  function drawGround(){
    ctx.fillStyle = '#2bbd00';
    ctx.fillRect(0,GROUND_Y,c.width,c.height-GROUND_Y);
  }
  function drawMonkey(){
    // simple cartoon monkey: blue body with face patch
    const m = player;
    // body
    ctx.fillStyle = '#1579ff';
    ctx.fillRect(m.x, m.y, m.w, m.h);
    // head
    ctx.fillStyle = '#1579ff';
    ctx.fillRect(m.x-2, m.y-18, m.w+4, 18);
    // face patch
    ctx.fillStyle = '#ffe1a8';
    ctx.fillRect(m.x+4, m.y-14, m.w-8, 12);
    // eyes
    ctx.fillStyle = '#000';
    ctx.fillRect(m.x+9, m.y-11, 3, 4);
    ctx.fillRect(m.x+16, m.y-11, 3, 4);
    // tail
    ctx.strokeStyle = '#1579ff';
    ctx.lineWidth = 3;
    ctx.beginPath();
    ctx.moveTo(m.x+m.w, m.y+8);
    ctx.quadraticCurveTo(m.x+m.w+14, m.y, m.x+m.w+10, m.y+18);
    ctx.stroke();
  }
  function drawRocks(){
    ctx.fillStyle = '#6a6a6a';
    rocks.forEach(r=>{
      ctx.beginPath();
      ctx.arc(r.x + r.w/2, r.y + r.h/2, r.r, 0, Math.PI*2);
      ctx.fill();
    });
  }
  function drawHUD(){
    ctx.fillStyle = '#fff';
    ctx.font = 'bold 16px system-ui, Arial';
    ctx.textAlign = 'left';
    ctx.fillText('Time: ' + Math.max(0, timeLeft).toFixed(1), 10, 20);
    if (message){
      ctx.textAlign = 'center';
      ctx.fillText(message, c.width/2, 50);
    }
  }

  // LOOP
  function step(){
    requestAnimationFrame(step);
    ctx.clearRect(0,0,c.width,c.height);

    // physics/update
    if (running){
      // spawn
      spawnIfNeeded();
      // move rocks
      rocks.forEach(r => r.x -= speed);
      // remove offscreen
      rocks = rocks.filter(r => r.x + r.w > -10);
      // player gravity
      player.vy += gravity;
      player.y += player.vy;
      if (player.y + player.h >= GROUND_Y){
        player.y = GROUND_Y - player.h;
        player.vy = 0;
        player.onGround = true;
      }
      // collisions
      for (const r of rocks){
        if (rectsOverlap(player, r)){
          running = false;
          message = 'Game Over — tap to restart';
        }
      }
      // timer
      t++;
      if (t % 60 === 0) timeLeft -= 1;
      if (timeLeft <= 0 && message === ''){
        running = false;
        message = 'You Win! Tap to play again';
      }
    } else {
      // allow quick restart if game ended
      c.onclick = () => { if (message) { reset(); running = true; message=''; } };
    }

    // draw
    drawGround();
    drawRocks();
    drawMonkey();
    drawHUD();
  }
  step();
})();
</script>
</body>
</html>
